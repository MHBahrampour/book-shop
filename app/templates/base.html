<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Load online stylesheets -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <!-- Load fonts from Google Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;600;700;800;900&display=swap" rel="stylesheet"> 

  <!-- Load local stylesheets -->
  {% load static %}
  <link rel="stylesheet" type="text/css" href="{% static 'app/styles.css' %}">

  <!-- Set title of the page -->
  {% block title %}<title>Book Shop</title>{% endblock %}

</head>
<body class="base-container">
  
  {% block sidebar %}
    <nav class="topnav sticky" id="topNav">

      <!-- Higligth/Active current page nav bar button -->
      {% with url_name=request.resolver_match.url_name %}

        <a href="{% url 'index' %}" class="btn {% if url_name == 'index' %}active{% endif %}">Home</a>
        <a href="{% url 'books' %}" class="btn {% if url_name == 'books' %}active{% endif %}">Books</a>
        <a href="{% url 'authors' %}" class="btn {% if url_name == 'authors' %}active{% endif %}">Authors</a>
        <a href="{% url 'genres' %}" class="btn {% if url_name == 'genres' %}active{% endif %}">Genres</a>
        
        {% if user.is_authenticated %}
          <a href="{% url 'show_shopping_cart' %} "class="btn {% if url_name == 'show_shopping_cart' %}active{% endif %}">Shopping Cart</a>
          <a href="{% url 'logout'%}?next={{request.path}}" class="btn {% if url_name == 'logout' %}active{% endif %}">Logout</a>
        {% else %}
          <a href="{% url 'signup'%}?next={{request.path}}" class="btn {% if url_name == 'signup' %}active{% endif %}">Signup</a>
          <a href="{% url 'login'%}?next={{request.path}}" class="btn {% if url_name == 'login' %}active{% endif %}">Login</a>
        {% endif %}

      {% endwith %}

      <div class="search-container center-vertically" id="searchForm">
        <form action="{% url 'search' %}" method="get">
          <input type="text" name="query" id="input_query" placeholder="Search for books...">
          <button type="submit"><i class="fa fa-search"></i></button>
        </form>
      </div>

      <a class="icon" id="dropDownNav">
        <i class="fa fa-bars"></i>
      </a>
      
    </nav>
  {% endblock %}

  <main style="margin: 1rem;">
    
    {% block content %}{% endblock %}

    {% block pagination %}

      {% if is_paginated %}

        <div class="pagination">
          <span class="page-links">
            {% if page_obj.has_previous %}
              <a href="{{ request.path }}?page={{ page_obj.previous_page_number }}">previous</a>
            {% endif %}
            <span class="page-current">
              Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
            </span>
            {% if page_obj.has_next %}
              <a href="{{ request.path }}?page={{ page_obj.next_page_number }}">next</a>
            {% endif %}
          </span>
        </div>

      {% endif %}

    {% endblock %}

  </main>

</body>
</html>

<script>
  // Nav bar for mobiles
  const dropDownNav = document.querySelector("#dropDownNav");

  dropDownNav.addEventListener('click', function() {
    const topNav = document.querySelector("#topNav");
    topNav.classList.toggle("responsive");

    const searchForm = document.querySelector("#searchForm");
    if ( getComputedStyle(searchForm).display == "none" ) {
      searchForm.style.display = "block";
      searchForm.classList.remove("center-vertically");
    } else {
      searchForm.style.display = "none";
    }
  });
</script>